create database flight;
use flight;
create table flights(flno int primary key,src varchar(30),dest varchar(30),dist int,departs timestamp,arrives timestamp,price int);
create table air(aid int primary key,aname varchar(20),crange int);
create table employee(eid int primary key,ename varchar(20),salary int);
create table certifid(eid int references employee(eid),aid int references aircraft(aid));
insert into air values(101,'747',3000);
insert into air values(102,'boeing',390);
insert into air values(103,'s46',2000);
insert into air values(104,'boeing',5000);
insert into air values(105,'Dreamliner',9000);
insert into air values(106,'Dream',1020);
insert into employee values(701,'A',50000);
insert into employee values(702,'B',58000);
insert into employee values(703,'C',80000);
insert into employee values(704,'D',20000);
insert into employee values(705,'E',30000);
insert into employee values(706,'F',100000);
insert into employee values(707,'G',2000000);
insert into certifid values(701,101);
insert into certifid values(701,103);
insert into certifid values(701,102);
insert into certifid values(701,104);
insert into certifid values(701,106);
insert into certifid values(702,104);
insert into certifid values(703,102);
insert into certifid values(704,105);
insert into certifid values(702,106);
insert into certifid values(705,101);
insert into certifid values(705,103);
insert into certifid values(706,101);
insert into certifid values(706,106);
select * from certifid;
insert into flights values(10,'japan','india',2000,'12/11/15 10:15:17','12/11/15 10:15:17',5000);
insert into flights values(12,'usa','india',20000,'12/11/15 10:15:17','12/11/15 10:15:17',20000);
insert into flights values(15,'india','korea',1000,'12/11/15 10:15:17','12/11/15 10:15:17',9000);
insert into flights values(13,'china','uk',30000,'12/11/15 10:15:17','12/11/15 10:15:17',25000);
insert into flights values(14,'vietnam','uae',5000,'12/11/15 10:15:17','12/11/15 10:15:17',15000);
insert into flights values(16,'bengaluru','frankfurt',52000,'12/11/15 13:15:17','12/11/15 10:15:17',115000);

select aname from air where aid in(select aid from certifid where eid in(select eid from employee where salary>80000));
select c.eid,max(a.crange) from certifid c,air a where a.aid=c.aid group by c.eid having count(*)>3; 
select e.ename from employee e where e.salary < (select min(f.price) from flights f where f.src='bengaluru' and f.dest='frankfurt');
select a.aname,avg(e.salary) from air a,employee e,certifid c where a.aid=c.aid and c.eid = e.eid and a.crange>1000 group by a.aname;
select e.ename from employee e where eid in(select eid from certifid where aid in(select aid from air where aname = 'boeing'));
